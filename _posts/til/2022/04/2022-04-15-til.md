---
title: 'TIL-220415 todolist 프로젝트 12일차'
date: 2022-04-15
permalink: /til/2022/04/15
categories:
  - TIL
tags:
  - TIL
  - 일일회고
  - 코드 스쿼드
toc: true
toc_label: '목차'
toc_sticky: true
---

<!--more-->


## 🛎 **하루 일과**

> 10:00 ~ 10:30 데일리 스크럼    
> 12:00 ~ 17:00 todolist 프로젝트  
> 21:00 ~ 22:30 코드 리뷰 정리  
> 22:45 ~ 01:30 todolist 프로젝트

## 👨‍💻 **학습 회고**

### **🤝 todolist 프로젝트**

- [3차 코드 리뷰](https://github.com/codesquad-members-2022/todo-list/pull/152)

### **⭕️ 리뷰 반영**

---

  **1. cardController의 add 메서드 return 값이 애매하다는 리뷰.**   
  - 질문의 요지를 제대로 파악한건지는 모르겠지만, controller의 add 메서드에서 event처리 로직까지 들어있어서 그런것 같음.
  - EventService를 CardService 내부로 이동.

  **2. responsCardDto에게 section 값을 비교하는 책임을 위임하기 & if-else 제거하기**    
  - 후의 도움으로 if문 내부에서 값을 리턴하는 방식을 사용해 else 제거. -> return 문이 중복된다는 단점이 있지만 특별한 해결책을 찾지 못했음
  - Card 도메인 객체에게 section의 변경 여부를 확인하는 책임 위임.

  **3. put, delete 메서드에 최소한 요청 성공 여부를 알려주는 반환값 정도는 주도록 개선하기**
  
  ```java
  {
    code : 200
    message : "성공"
    content : {...}
  }
  ```
  - Response<T> 형태의 Dto를 만들고 내부에 content 필드의 타입을 제네릭으로 설정하는 방식으로 변경하면 좋겠다고 생각.
  - 모든 응답을 위의 형식으로 보내주는게 맞을것같다고 전부터 생각했지만 미루다보니 프로젝트가 끝나는 날이 와서 적용은 안했음.  
  
  **4. Action enum 내부에서 Event가 스스로 dto의값들을 사용하도록 개선하기**  
  - Event에게 dto에서 값을 꺼내서 넘겨줬는데 객체 스스로 결정해서 사용하도록 자율성을 보장해야한다. 그래서 dto를 넘겨주는 형식으로 변경

  **5.  ResponseCardsDto에서 Map의 키값을 enum 타입을 넣어서 표현하도록 개선하기**   
  - Section Enum 클래스를 작성하고 카드를 분류하는 로직을 Enum 클래스 내부로 옮김

### **🚫 앞으로 변경할 내용과 학습할 키워드**

---

- eventJdbcRepository의 rowMapper에서 컬럼명을 동적으로 관리할 방법 찾아보기
- `findAny()`는 id가 unique하지 않을 경우 동일성이 보장이 안되는데 이 부분을 개선 해보기
- Custom한 Exception 만들어보기
- action이 이루어진 목록을 인터셉터로 구현해보기
- `genarateKey`란?
- mysql에서 enum 타입을 사용하는것에 대한 의견 남기기 - [mysql에서 enum 타입을 사용하면 안되는 8가지 이유](http://komlenic.com/244/8-reasons-why-mysqls-enum-data-type-is-evil/)
- `executeAndReturnKey()`가 멀티스레드에서 사용해도 안전한 이유 알아보기


코드리뷰를 받게 되면 많은 키워드가 쏟아진다. 동시에 내가 습관적으로 작성하던 코드, 좋다니까 사용해보는 코드들에 대해 다시한번 생각해볼 수 있는 기회가 된다.  

<br>

이동욱님의 책에서 Entity객체는 DB와 직접적으로 연결되어 있는 객체이기 때문에 있는 반환용 Dto 객체를 만들어 반환해야한다는 내용을 보았고 바로 프로젝트에 적용했다. 하지만 적용하면서 들게 된 생각은 **"현재는 데이터의 개수가 적지만, 만약 데이터가 엄청 많다면 변환하는데 드는 오버헤드가 너무 크지 않을까"** 였다.  

<br>

해당 내용을 pr의 질문으로 남겼고 받은 리뷰에서 **_당연히 오버헤드가 발생하기 때문에 현재 애플리케이션에서 반드시 Dto 객체로 변환해야하는 이유가 있는지 고민해보고, 변환해야하는 이유가 있다면 근거를 가지고 설득할 수 있어야 한다_**는 피드백을 받았다.   
이런 피드백 덕분에 "대다수가 좋다고 하니까, 실력이 뛰어난 개발자분이 맞는 방식이라고 하니까" 무작정 적용했던 내 자신을 반성하게 된다.

### **Entity 객체를 그대로 반환하면 안되는 이유**

- 사용자에게 Entity 객체를 반환하게 되면 Entity 객체의 모든 필드, 즉 DB의 컬럼들이 그대로 사용자에게 공개된다.
- 사용자에게 반환하는 데이터는 중간에 변환하는 과정이 필요할 수 있는데 이것이 가능하려면 setter가 필요하다. Entity에 setter를 구현해두면 비즈니스 로직과 전혀 상관 없는 controller와 같은 곳에서 실수로 값의 변경이 발생할 수 있다.
- 사용자에게 필요도 없는 데이터까지 전부 보내는것은 자원의 낭비다.

## **💁🏻‍♂️ 개선점**

- 오늘은 만족! 💯
